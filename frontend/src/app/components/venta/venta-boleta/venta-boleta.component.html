<div class="modal-header bg-dark text-white">
    <h5 class="modal-title"><i class="bi bi-receipt"></i> Boleta de Venta</h5>
    <button type="button" class="btn-close btn-close-white" (click)="onClose()"></button>
</div>

<div class="modal-body">
    <div *ngIf="loading" class="text-center my-4">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Cargando...</span>
        </div>
    </div>

    <div *ngIf="error" class="alert alert-danger">
        {{ error }}
    </div>

    <div *ngIf="venta && !loading" class="boleta-container p-3 border rounded bg-white">
      
        <div class="text-center mb-4">
            <h3 class="fw-bold">PETSHOP S.A.C.</h3>
            <p class="mb-1">RUC: 20123456789</p>
            <p class="mb-1">Av. Principal 123, Pucallpa - Perú</p>
            <p class="mb-1">Tel: (01) 555-1234</p>
        </div>

        <hr class="border-2">

        <!-- Info Venta -->
        <div class="row mb-3">
            <div class="col-6">
                <strong>Cliente:</strong> {{ venta.clienteNombre || venta.nombre_cliente + ' ' + venta.apellido_cliente
                }}<br>
                <strong>Vendedor:</strong> {{ venta.usuarioNombre || venta.nombre_usuario }}
            </div>
            <div class="col-6 text-end">
                <strong>Boleta N°:</strong> {{ venta.id_venta | number:'5.0-0' }}<br>
                <strong>Fecha:</strong> {{ venta.fecha | date:'dd/MM/yyyy HH:mm' }}<br>
                <strong>Pago:</strong> {{ venta.tipo_pago }}
            </div>
        </div>

        <!-- Tabla Detalles -->
        <table class="table table-sm table-striped">
            <thead class="table-light">
                <tr>
                    <th>Cant.</th>
                    <th>Descripción</th>
                    <th class="text-end">P.Unit</th>
                    <th class="text-end">Importe</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let d of venta.detalles">
                    <td>{{ d.cantidad }}</td>
                    <td>{{ d.nombreItem }}</td>
                    <td class="text-end">{{ d.precio | currency:'PEN ' }}</td>
                    <td class="text-end">{{ d.subtotal | currency:'PEN ' }}</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-end fw-bold">TOTAL A PAGAR:</td>
                    <td class="text-end fw-bold fs-5">{{ venta.total | currency:'PEN ' }}</td>
                </tr>
            </tfoot>
        </table>

        <!-- Footer -->
        <div class="text-center mt-4 text-muted small">
            <p>¡Gracias por su preferencia!</p>
            <p>Conserve este documento para cualquier reclamo.</p>
        </div>
    </div>
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="onClose()">Cerrar</button>
    <button type="button" class="btn btn-danger me-2" (click)="exportarPDF()" [disabled]="!venta">
        <i class="bi bi-file-earmark-pdf"></i> Exportar PDF
    </button>

</div>